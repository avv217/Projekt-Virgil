<!doctype html><html lang="cs"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
        <h1>üß† Virgil Tripack v1.3.0</h1><title>Virgil Tripack v1.3.0</title>
<style>
:root{color-scheme:dark}body{margin:0;background:#0b0f14;color:#e6f0ff;font-family:system-ui,-apple-system,Segoe UI,Roboto}
.app{display:grid;grid-template-columns:280px 1fr 340px;height:100vh}
.sidebar,.rightbar{background:#0e141b;border-right:1px solid #15202b}.rightbar{border-left:1px solid #15202b;border-right:none}
h2{margin:0;padding:12px 14px;color:#87cbff;font:600 13px/1.2 system-ui;letter-spacing:.12em;text-transform:uppercase}
.section{padding:12px;border-top:1px solid #15202b}.msgs{height:calc(100vh - 220px);overflow:auto;background:#0b1219;border:1px solid #1b2a37;border-radius:12px;margin:12px;padding:8px}
.msg{padding:10px 12px;margin:8px;border-radius:10px}.msg.user{background:#132334}.msg.assistant{background:#111a23}
textarea,input,select{width:100%;background:#0e141b;color:#e6f0ff;border:1px solid #1b2a37;border-radius:10px;padding:10px}
.btn{background:#0f6abf;border:none;color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer}.row{display:flex;gap:8px;align-items:center}
.tag{font-size:12px;background:#0f1930;color:#8bd0ff;border:1px solid #1b2a37;padding:4px 8px;border-radius:999px;display:inline-block}
pre{white-space:pre-wrap}
.badge{font-size:11px;padding:2px 6px;border-radius:8px;border:1px solid #1b2a37;background:#0f1930;color:#9fd2ff}
</style></head>
<body><div class="app">
<div class="sidebar">
  <h2>Tripack</h2>
  <div class="section">
    <div class="row" style="justify-content:space-between;align-items:center">
      <div><span class="badge">UI</span> <span id="uiVer"></span></div>
      <div><span class="badge">LLM</span> <span id="llmMode">stub</span></div>
    </div>
  </div>
  <div class="section">
    <label>LLM model</label><select id="model"></select>
  </div>
  <div class="section">
    <label>Re≈æim</label><select id="mode"><option>Airplane</option><option selected>Local only</option><option>Online allowed</option></select>
  </div>
  <div class="section">
    <button class="btn" onclick="health()">Kontrola z√°vislost√≠</button>
    <pre id="healthOut" style="font-size:12px;margin-top:8px"></pre>
  </div>
</div>
<div>
  <div class="msgs" id="msgs"></div>
  <div class="section"><div class="row">
    <textarea id="input" placeholder="Napi≈° dotaz‚Ä¶ (Enter = odeslat, Shift+Enter = nov√Ω ≈ô√°dek)" onkeydown="handleKeyDown(event)"></textarea>
    <button class="btn" onclick="send()">Odeslat</button>
  </div></div>
</div>
<div class="rightbar">
  <h2>Pamƒõ≈•</h2>
  <div class="section">
    <div class="row"><input id="memTitle" placeholder="N√°zev"></div>
    <div class="row" style="margin-top:8px"><input id="memTags" placeholder="Tagy (ƒç√°rkou)"></div>
    <div class="row" style="margin-top:8px"><textarea id="memText" placeholder="Text pozn√°mky‚Ä¶"></textarea></div>
    <div class="row" style="margin-top:8px">
      <label><input type="checkbox" id="toMem" checked> do pamƒõti</label>
      <label><input type="checkbox" id="toExc"> do v√Ωjimek</label>
      <label><input type="checkbox" id="enc"> ≈°ifrovat</label>
      <input id="pass" placeholder="heslo (pro ≈°ifrov√°n√≠)" style="width:40%">
    </div>
    <div class="row" style="justify-content:flex-end;margin-top:8px">
      <button class="btn" onclick="saveMem()">Ulo≈æit</button>
    </div>
  </div>
  <div class="section">
    <button class="btn" onclick="loadMem()">Naƒç√≠st pamƒõ≈•</button>
    <pre id="memOut" style="font-size:12px;margin-top:8px"></pre>
  </div>
  <h2>Nastaven√≠</h2>
  <div class="section">
    <div class="row">
      <label>Compute backend:</label>
      <select id="computeBackend">
        <option value="cpu">CPU</option>
        <option value="gpu">GPU</option>
        <option value="auto">Auto</option>
      </select>
    </div>
    <div class="row">
      <label>Online re≈æim:</label>
      <input type="checkbox" id="onlineMode"> <span>Povolit stahov√°n√≠</span>
    </div>
    <button class="btn" onclick="saveSettings()">Ulo≈æit nastaven√≠</button>
  </div>
  <h2>Stahov√°n√≠ model≈Ø</h2>
  <div class="section">
    <h3>üîç Model Search & Download</h3>
    <input type="text" id="searchQuery" placeholder="Napi≈°te n√°zev modelu (nap≈ô. mistral, llama, qwen)" style="width:100%;margin:8px 0;padding:8px;background:#1b2a37;border:1px solid #2d3748;color:#e2e8f0;border-radius:4px">
    <div style="margin:8px 0">
      <button onclick="searchModels()" style="background:#0f6abf;color:white;border:none;padding:8px 16px;border-radius:4px;margin-right:8px;cursor:pointer">üîç Vyhledat modely</button>
    </div>
    <hr style="border:1px solid #2d3748;margin:16px 0">
    <input type="text" id="hfUrl" placeholder="Nebo zadejte p≈ô√≠mou HuggingFace URL" style="width:100%;margin:8px 0;padding:8px;background:#1b2a37;border:1px solid #2d3748;color:#e2e8f0;border-radius:4px">
    <input type="text" id="modelId" placeholder="Model ID (voliteln√©)" style="width:100%;margin:8px 0;padding:8px;background:#1b2a37;border:1px solid #2d3748;color:#e2e8f0;border-radius:4px">
    <div style="margin:8px 0">
      <button onclick="browseRepo()" style="background:#16a085;color:white;border:none;padding:8px 16px;border-radius:4px;margin-right:8px;cursor:pointer">üìÇ Proch√°zet repo</button>
      <button onclick="downloadDirect()" style="background:#16a085;color:white;border:none;padding:8px 16px;border-radius:4px;cursor:pointer">‚¨áÔ∏è P≈ô√≠m√© sta≈æen√≠</button>
    </div>
    <div id="modelBrowser" style="margin-top:8px;display:none">
      <div style="max-height:200px;overflow:auto;border:1px solid #1b2a37;border-radius:8px;padding:8px">
        <div id="modelList"></div>
      </div>
    </div>
    <pre id="downloadOut" style="font-size:12px;margin-top:8px"></pre>
  </div>
  <h2>Syst√©m</h2>
  <div class="section">
    <div class="row">
      <span>UI verze:</span> <span id="uiVer">nezn√°m√°</span>
    </div>
    <div class="row">
      <span>LLM re≈æim:</span> <span id="llmMode">nezn√°m√Ω</span>
    </div>
    <button class="btn" onclick="health()">Health check</button>
    <pre id="healthOut" style="font-size:12px;margin-top:8px"></pre>
  </div>
  </div>
</div>
</div>
<script>
async function loadModels(){const r=await fetch('/api/models/list');const d=await r.json();const sel=document.getElementById('model');sel.innerHTML='';(d.llm||[]).forEach(m=>{const o=document.createElement('option');o.value=m;o.textContent=m;sel.appendChild(o);});}
function push(role,content){const m=document.getElementById('msgs');const d=document.createElement('div');d.className='msg '+role;const t=document.createElement('div');t.className='tag';t.textContent=role;const b=document.createElement('div');b.textContent=content;d.appendChild(t);d.appendChild(b);m.appendChild(d);m.scrollTop=m.scrollHeight;}
async function send(){const text=document.getElementById('input').value.trim();const model=document.getElementById('model').value;if(!text)return;push('user',text);document.getElementById('input').value='';const r=await fetch('/api/models/llm/generate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({model_id:model,prompt:text,params:{temperature:0.7,max_tokens:256}})});const d=await r.json();push('assistant',d.text||'[bez odpovƒõdi]');}
async function saveMem(){const title=document.getElementById('memTitle').value;const tags=document.getElementById('memTags').value.split(',').map(s=>s.trim()).filter(Boolean);const text=document.getElementById('memText').value;const to_memory=document.getElementById('toMem').checked;const to_exceptions=document.getElementById('toExc').checked;const encrypt=document.getElementById('enc').checked;const passphrase=document.getElementById('pass').value||null;await fetch('/api/brain/memory/save',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({title,tags,text,type:"note",to_memory,to_exceptions,encrypt,passphrase})});document.getElementById('memText').value='';}
async function loadMem(){const r=await fetch('/api/brain/memory');const d=await r.json();document.getElementById('memOut').textContent=JSON.stringify(d,null,2);}
async function health(){const r=await fetch('/api/health');const d=await r.json();document.getElementById('healthOut').textContent=JSON.stringify(d,null,2);document.getElementById('uiVer').textContent=d.ui_version;document.getElementById('llmMode').textContent=d.llm_mode;}
async function loadSettings(){const r=await fetch('/api/settings');const d=await r.json();document.getElementById('computeBackend').value=d.compute_backend||'cpu';document.getElementById('onlineMode').checked=d.online_mode||false;}
async function saveSettings(){const computeBackend=document.getElementById('computeBackend').value;const onlineMode=document.getElementById('onlineMode').checked;await fetch('/api/settings',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({theme:'dark',device:'desktop',selected_model:'',llm_mode:'stub',compute_backend:computeBackend,online_mode:onlineMode})});push('assistant','Nastaven√≠ ulo≈æeno: '+computeBackend+', online: '+onlineMode);}
function handleKeyDown(event){if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();send();}else if(event.key==='Enter'&&event.shiftKey){return true;}}
async function searchModels(){const query=document.getElementById('searchQuery').value.trim();if(!query){push('assistant','Zadejte n√°zev modelu pro vyhled√°n√≠');return;}document.getElementById('downloadOut').textContent='Vyhled√°v√°m modely...';const r=await fetch('/api/models/search_hf',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({query:query,limit:10})});const d=await r.json();if(d.ok){const browser=document.getElementById('modelBrowser');const list=document.getElementById('modelList');list.innerHTML='';d.models.forEach(model=>{const item=document.createElement('div');item.style.cssText='padding:12px;margin:8px 0;border:1px solid #1b2a37;border-radius:8px;cursor:pointer;background:#0e141b;transition:background 0.2s';item.innerHTML=`<div style="font-weight:bold;font-size:14px;margin-bottom:4px">${model.id}</div><div style="font-size:11px;color:#9fd2ff;margin-bottom:6px">${model.description}</div><div style="font-size:10px;color:#8bd0ff">${model.downloads} downloads</div>`;item.onmouseover=()=>item.style.background='#1a2332';item.onmouseout=()=>item.style.background='#0e141b';item.onclick=()=>browseModelRepo(model.repo_url);list.appendChild(item);});browser.style.display='block';document.getElementById('downloadOut').textContent=`Nalezeno ${d.models.length} model≈Ø pro "${query}"`;}else{document.getElementById('downloadOut').textContent='Chyba: '+d.error;}}
async function browseModelRepo(repoUrl){document.getElementById('downloadOut').textContent='Naƒç√≠t√°m dostupn√© soubory...';const r=await fetch('/api/models/browse_hf_repo',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({repo_url:repoUrl})});const d=await r.json();if(d.ok){const list=document.getElementById('modelList');list.innerHTML='';d.models.forEach(model=>{const item=document.createElement('div');item.style.cssText='padding:8px;margin:4px 0;border:1px solid #1b2a37;border-radius:8px;cursor:pointer;background:#0e141b';item.innerHTML=`<div style="font-weight:bold">${model.filename}</div><div style="font-size:11px;color:#8bd0ff;margin:4px 0">${model.capabilities.map(c=>`<span class="tag">${c}</span>`).join(' ')}</div><div style="font-size:11px;color:#9fd2ff">${model.size_mb} MB ‚Ä¢ ${model.format}</div>`;item.onclick=()=>downloadFromBrowser(model.download_url,model.filename);list.appendChild(item);});document.getElementById('downloadOut').textContent=`Nalezeno ${d.models.length} soubor≈Ø v ${d.repo}`;}else{document.getElementById('downloadOut').textContent='Chyba: '+d.error;}}
async function browseRepo(){const url=document.getElementById('hfUrl').value.trim();if(!url){push('assistant','Zadejte HF repository URL');return;}browseModelRepo(url);}
async function downloadFromBrowser(url,filename){const progressBar=document.createElement('div');progressBar.innerHTML='<div style="background:#1b2a37;border-radius:10px;padding:2px;margin:8px 0"><div id="progressFill" style="background:#0f6abf;height:20px;border-radius:8px;width:0%;transition:width 0.3s;text-align:center;line-height:20px;color:white;font-size:12px">0%</div></div>';document.getElementById('downloadOut').innerHTML='';document.getElementById('downloadOut').appendChild(progressBar);const downloadPromise=fetch('/api/models/add_from_hf',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({url,model_type:'llm',id:null})});const progressInterval=setInterval(async()=>{try{const progResp=await fetch(`/api/models/download_progress/${encodeURIComponent(filename)}`);const progData=await progResp.json();if(progData.ok&&progData.progress){const prog=progData.progress;document.getElementById('progressFill').style.width=prog.progress_percent+'%';document.getElementById('progressFill').textContent=prog.progress_percent+'%';if(prog.status==='completed'||prog.status==='error'){clearInterval(progressInterval);}}}catch(e){console.log('Progress check failed:',e);}},1000);const r=await downloadPromise;clearInterval(progressInterval);document.getElementById('progressFill').style.width='100%';document.getElementById('progressFill').textContent='100%';const d=await r.json();setTimeout(()=>{document.getElementById('downloadOut').textContent=JSON.stringify(d,null,2);if(d.ok){push('assistant',`Model ${filename} sta≈æen! Format: ${d.format}, Capabilities: ${d.capabilities.join(', ')}`);loadModels();document.getElementById('modelBrowser').style.display='none';}else{push('assistant','Chyba stahov√°n√≠: '+d.error);}},1000);}
async function downloadDirect(){const url=document.getElementById('hfUrl').value.trim();const modelId=document.getElementById('modelId').value.trim()||null;if(!url){push('assistant','Zadejte p≈ô√≠m√Ω URL souboru');return;}const progressBar=document.createElement('div');progressBar.innerHTML='<div style="background:#1b2a37;border-radius:10px;padding:2px;margin:8px 0"><div id="progressFill" style="background:#0f6abf;height:20px;border-radius:8px;width:0%;transition:width 0.3s;text-align:center;line-height:20px;color:white;font-size:12px">0%</div></div>';document.getElementById('downloadOut').innerHTML='';document.getElementById('downloadOut').appendChild(progressBar);let progress=0;const progressInterval=setInterval(()=>{progress+=Math.random()*10;if(progress>90)progress=90;document.getElementById('progressFill').style.width=progress+'%';document.getElementById('progressFill').textContent=Math.round(progress)+'%';},500);const r=await fetch('/api/models/add_from_hf',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({url,model_type:'llm',id:modelId})});clearInterval(progressInterval);document.getElementById('progressFill').style.width='100%';document.getElementById('progressFill').textContent='100%';const d=await r.json();setTimeout(()=>{document.getElementById('downloadOut').textContent=JSON.stringify(d,null,2);if(d.ok){push('assistant','Model sta≈æen: '+d.message+' ('+d.format+', '+d.capabilities.join(', ')+')');loadModels();}else{push('assistant','Chyba stahov√°n√≠: '+d.error);}},1000);}
loadModels();loadSettings();health();push('assistant','V√≠tej ve Virgil Tripack v1.3.0! Nov√° funkce: Vlo≈æte HF repository URL a proch√°zejte dostupn√© modely. Automatick√° detekce capabilities a form√°t≈Ø.');
</script>
</body></html>
